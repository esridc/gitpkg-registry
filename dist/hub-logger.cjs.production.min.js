"use strict";function e(e){return e&&"object"==typeof e&&"default"in e?e.default:e}var t=e(require("morgan")),r=e(require("winston"));function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var i={error:4,warn:3,info:2,debug:1};function o(e){void 0===e&&(e="");var t=/(.+?\.js):(\d+):\d+/;return(e.split("\n").find(function(e){return t.test(e)})||"").trim()}function s(e,t,r,i){void 0===i&&(i={});var o=t instanceof Date?t.toISOString():t;return Object.entries(n({level:e,timestamp:o,status:r},i)).map(function(e){return e[0]+"="+JSON.stringify(e[1])}).join(" ")}exports.HubLogger=function(){function e(e){var t,n;void 0===e&&(e={}),this.winstonLogger=void 0,this.sizeLimit=void 0,this.globalLabels=void 0,this.level=void 0,this.sizeLimit=this.getSizeLimit(e.sizeLimit),this.globalLabels=null!=(t=e.labels)?t:{},this.level=null!=(n=e.level)?n:"info";var i=new r.transports.Console({level:this.level,format:r.format.printf(function(e){return e.message}),handleExceptions:!0,handleRejections:!0});this.winstonLogger=r.createLogger({transports:[i]})}var n=e.prototype;return n.log=function(e,t,r){var n=new Date,i=s(e,n,t,Object.assign({},this.globalLabels,r));i.length>this.sizeLimit&&(this.warn("oversize-log-truncated",{timestamp:n.toISOString()}),i=("TOO LONG TRUNCATED "+i.slice(0,this.sizeLimit)).trim()),this.winstonLogger[e](i)},n.getSizeLimit=function(e){var t;return(e=null!=(t=e)?t:2e5)<100?100:e>2e5?2e5:e},n.info=function(e,t){this.log("info",e,t)},n.debug=function(e,t){this.log("debug",e,t)},n.warn=function(e,t){this.log("warn",e,t)},n.error=function(e,t){var r;t instanceof Error?(r={errorName:t.name,errorMessage:t.message},t.stack&&(r.source=o(t.stack))):r=t,this.log("error",e,r)},n.shouldLog=function(e){return i[e]>=i[this.level]},n.getRequestLogLevel=function(e){return!e||e>=500?"error":e>=400?"warn":"debug"},n.getRequestLogStatus=function(e){return"debug"===e?"request-succeeded":"request-failed"},n.createRequestLogger=function(e){var r=this;void 0===e&&(e={});var n=Object.assign({},e,{skip:function(e,t){return!r.shouldLog(r.getRequestLogLevel(t.statusCode))}});return t(function(e,t,n){var i=e.method(t,n),o=e.url(t,n),u=n.statusCode,a=e.date(t,n,"iso"),l=Number(e["response-time"](t,n)),g=r.getRequestLogLevel(n.statusCode);return s(g,a,r.getRequestLogStatus(g),{method:i,url:o,statusCode:u,responseTime:l})},n)},e}(),exports.formatLog=s,exports.getErrorSource=o;
//# sourceMappingURL=hub-logger.cjs.production.min.js.map
